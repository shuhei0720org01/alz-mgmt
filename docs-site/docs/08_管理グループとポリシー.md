# 08. ç®¡ç†ã‚°ãƒ«ãƒ¼ãƒ—ã¨ãƒãƒªã‚·ãƒ¼ - ã‚¬ãƒãƒŠãƒ³ã‚¹ã®è¦

## 8ã¤ã®è¨­è¨ˆé ˜åŸŸã¨ã®å¯¾å¿œ

ã“ã®Chapterã¯ä»¥ä¸‹ã®è¨­è¨ˆé ˜åŸŸã‚’å®Ÿè£…ã—ã¾ã™ï¼š
- âœ… **2. Identity and Access Management**ï¼ˆIDãƒ»ã‚¢ã‚¯ã‚»ã‚¹ç®¡ç† - RBACã€æ¨©é™ç®¡ç†ï¼‰
- âœ… **3. Resource Organization**ï¼ˆãƒªã‚½ãƒ¼ã‚¹æ•´ç† - ç®¡ç†ã‚°ãƒ«ãƒ¼ãƒ—éšå±¤ï¼‰
- âœ… **5. Security**ï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼ï¼‰
- âœ… **7. Governance**ï¼ˆã‚¬ãƒãƒŠãƒ³ã‚¹ - ãƒãƒªã‚·ãƒ¼å®šç¾©ã¨é©ç”¨ï¼‰

â†’ Chapter 01ã§å­¦ã‚“ã 8ã¤ã®è¨­è¨ˆé ˜åŸŸã‚’å¾©ç¿’ã—ãŸã„æ–¹ã¯[01_åŸºç¤çŸ¥è­˜.md](./01_åŸºç¤çŸ¥è­˜.md)ã¸

---

## ã“ã®Chapterã§ã‚„ã‚‹ã“ã¨

ç®¡ç†ã‚°ãƒ«ãƒ¼ãƒ—ã¨ãƒãƒªã‚·ãƒ¼ã®ä»•çµ„ã¿ã‚’ç†è§£ã—ã‚ˆã†ã€‚

**ç®¡ç†ã‚°ãƒ«ãƒ¼ãƒ—ã£ã¦ä½•ï¼Ÿ**
ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŸã­ã‚‹ã€Œãƒ•ã‚©ãƒ«ãƒ€ã€ã¿ãŸã„ãªã‚‚ã‚“ã€‚

**ãƒãƒªã‚·ãƒ¼ã£ã¦ä½•ï¼Ÿ**
ã€Œã“ã‚Œã‚„ã£ã¡ã‚ƒãƒ€ãƒ¡ã€ã€Œã“ã‚Œã‚„ã‚‰ãªã„ã¨ãƒ€ãƒ¡ã€ã¿ãŸã„ãªãƒ«ãƒ¼ãƒ«ã€‚

**ä¾‹ãˆã‚‹ãªã‚‰**ï¼š
- **ç®¡ç†ã‚°ãƒ«ãƒ¼ãƒ—**ï¼šä¼šç¤¾ã®éƒ¨ç½²ï¼ˆå–¶æ¥­éƒ¨ã€é–‹ç™ºéƒ¨ã€ç·å‹™éƒ¨ï¼‰
- **ãƒãƒªã‚·ãƒ¼**ï¼šç¤¾å†…è¦å®šï¼ˆã€ŒçµŒè²»ã¯1ä¸‡å††ã¾ã§ã€ã€Œã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç ”ä¿®å¿…é ˆã€ï¼‰
- **ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³**ï¼šå„ãƒãƒ¼ãƒ 

---

## ç®¡ç†ã‚°ãƒ«ãƒ¼ãƒ—ã®åŸºæœ¬

### éšå±¤æ§‹é€ 

**ğŸ“Š ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ç®¡ç†ã‚°ãƒ«ãƒ¼ãƒ—éšå±¤ï¼ˆå®Œå…¨ç‰ˆï¼‰**

```
Tenant Root Groupï¼ˆæœ€ä¸Šä½ï¼‰
â”‚
â””â”€â”€ alzï¼ˆAzure Landing Zonesï¼‰
    â”‚
    â”œâ”€â”€ platformï¼ˆãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å±¤ï¼‰â”€ ã‚¤ãƒ³ãƒ•ãƒ©åŸºç›¤ãƒãƒ¼ãƒ 
    â”‚   â”œâ”€â”€ managementï¼ˆç®¡ç†ï¼‰â”€ ãƒ­ã‚°ãƒ»ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ 
    â”‚   â”‚   â””â”€â”€ [Subscription: Management]
    â”‚   â”‚       â”œâ”€â”€ Log Analytics Workspace
    â”‚   â”‚       â”œâ”€â”€ Automation Account
    â”‚   â”‚       â””â”€â”€ Data Collection Rules
    â”‚   â”‚
    â”‚   â”œâ”€â”€ connectivityï¼ˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼‰â”€ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åŸºç›¤
    â”‚   â”‚   â””â”€â”€ [Subscription: Connectivity]
    â”‚   â”‚       â”œâ”€â”€ Hub VNetï¼ˆæ±æ—¥æœ¬ãƒ»è¥¿æ—¥æœ¬ï¼‰
    â”‚   â”‚       â”œâ”€â”€ Firewall
    â”‚   â”‚       â”œâ”€â”€ Bastion
    â”‚   â”‚       â””â”€â”€ VPN/ExpressRoute Gateway
    â”‚   â”‚
    â”‚   â”œâ”€â”€ identityï¼ˆIDç®¡ç†ï¼‰â”€ èªè¨¼ãƒ»èªå¯ã‚·ã‚¹ãƒ†ãƒ 
    â”‚   â”‚   â””â”€â”€ [Subscription: Identity]
    â”‚   â”‚       â””â”€â”€ Azure AD Domain Servicesç­‰
    â”‚   â”‚
    â”‚   â””â”€â”€ securityï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ï¼‰â”€ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–
    â”‚       â””â”€â”€ [Subscription: Security]
    â”‚           â””â”€â”€ Defender for Cloudç­‰
    â”‚
    â”œâ”€â”€ landingzonesï¼ˆãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã‚¾ãƒ¼ãƒ³å±¤ï¼‰â”€ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
    â”‚   â”œâ”€â”€ corpï¼ˆç¤¾å†…ã‚¢ãƒ—ãƒªï¼‰â”€ ç¤¾å†…ã‚·ã‚¹ãƒ†ãƒ ç”¨
    â”‚   â”‚   â””â”€â”€ [Subscription: Corp-App]
    â”‚   â”‚       â””â”€â”€ ä¼šè¨ˆã‚·ã‚¹ãƒ†ãƒ ã€äººäº‹ã‚·ã‚¹ãƒ†ãƒ ç­‰
    â”‚   â”‚
    â”‚   â””â”€â”€ onlineï¼ˆå…¬é–‹ã‚¢ãƒ—ãƒªï¼‰â”€ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆå…¬é–‹ç”¨
    â”‚       â””â”€â”€ [Subscription: Online-App]
    â”‚           â””â”€â”€ Webã‚µãƒ¼ãƒ“ã‚¹ã€APIç­‰
    â”‚
    â”œâ”€â”€ sandboxï¼ˆå®Ÿé¨“ç’°å¢ƒï¼‰â”€ æ¤œè¨¼ãƒ»ãƒ†ã‚¹ãƒˆç”¨
    â”‚   â””â”€â”€ [Subscription: Sandbox]
    â”‚       â””â”€â”€ é–‹ç™ºè€…ãŒè‡ªç”±ã«ä½¿ãˆã‚‹
    â”‚
    â””â”€â”€ decommissionedï¼ˆå»ƒæ­¢äºˆå®šï¼‰â”€ å‰Šé™¤å‰ã®ä¸€æ™‚ä¿ç®¡
        â””â”€â”€ [Subscription: Old-System]
            â””â”€â”€ å‰Šé™¤äºˆå®šã®ãƒªã‚½ãƒ¼ã‚¹
```

**ğŸ¯ å„å±¤ã®å½¹å‰²ã¾ã¨ã‚**

| ç®¡ç†ã‚°ãƒ«ãƒ¼ãƒ— | å½¹å‰² | èª°ãŒä½¿ã† | ãƒãƒªã‚·ãƒ¼ |
|-------------|------|---------|--------|
| **platform** | ã‚¤ãƒ³ãƒ•ãƒ©åŸºç›¤ | ã‚¤ãƒ³ãƒ•ãƒ©ãƒãƒ¼ãƒ  | å³ã—ã„ï¼ˆå¤‰æ›´åˆ¶é™ï¼‰ |
| - management | ãƒ­ã‚°ãƒ»ç›£è¦– | ã‚¤ãƒ³ãƒ•ãƒ©ãƒãƒ¼ãƒ  | å‰Šé™¤ç¦æ­¢ |
| - connectivity | ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ | ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒãƒ¼ãƒ  | å¤‰æ›´è¦æ‰¿èª |
| - identity | èªè¨¼ãƒ»èªå¯ | ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒ¼ãƒ  | æœ€é«˜ãƒ¬ãƒ™ãƒ« |
| - security | ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦– | ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒ¼ãƒ  | æœ€é«˜ãƒ¬ãƒ™ãƒ« |
| **landingzones** | ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ | é–‹ç™ºãƒãƒ¼ãƒ  | æ¨™æº– |
| - corp | ç¤¾å†…ã‚¢ãƒ—ãƒª | é–‹ç™ºãƒãƒ¼ãƒ  | æ¨™æº–+ç¤¾å†…æ¥ç¶šã®ã¿ |
| - online | å…¬é–‹ã‚¢ãƒ—ãƒª | é–‹ç™ºãƒãƒ¼ãƒ  | æ¨™æº–+ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆè¨±å¯ |
| **sandbox** | å®Ÿé¨“ç’°å¢ƒ | å…¨å“¡ | ç·©ã„ï¼ˆè‡ªç”±ã«å®Ÿé¨“ï¼‰ |
| **decommissioned** | å»ƒæ­¢äºˆå®š | å‰Šé™¤æ‹…å½“è€… | èª­ã¿å–ã‚Šå°‚ç”¨ |

```
Tenant Root Groupï¼ˆãƒ†ãƒŠãƒ³ãƒˆãƒ«ãƒ¼ãƒˆï¼‰
  â””â”€â”€ alzï¼ˆAzure Landing Zonesï¼‰
      â”œâ”€â”€ platformï¼ˆãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ï¼‰
      â”‚   â”œâ”€â”€ managementï¼ˆç®¡ç†ï¼‰
      â”‚   â”œâ”€â”€ connectivityï¼ˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼‰
      â”‚   â”œâ”€â”€ identityï¼ˆIDç®¡ç†ï¼‰
      â”‚   â””â”€â”€ securityï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ï¼‰
      â”œâ”€â”€ landingzonesï¼ˆãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã‚¾ãƒ¼ãƒ³ï¼‰
      â”‚   â”œâ”€â”€ corpï¼ˆç¤¾å†…ã‚¢ãƒ—ãƒªï¼‰
      â”‚   â””â”€â”€ onlineï¼ˆã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆå…¬é–‹ï¼‰
      â”œâ”€â”€ sandboxï¼ˆæ¤œè¨¼ç’°å¢ƒï¼‰
      â””â”€â”€ decommissionedï¼ˆå»ƒæ­¢äºˆå®šï¼‰
```

**éšå±¤ã®ãƒ«ãƒ¼ãƒ«**ï¼š
- æœ€å¤§6éšå±¤ã¾ã§
- 1ã¤ã®ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã¯1ã¤ã®ç®¡ç†ã‚°ãƒ«ãƒ¼ãƒ—ã«ã®ã¿æ‰€å±
- ãƒãƒªã‚·ãƒ¼ã¯å­ã«ç¶™æ‰¿ã•ã‚Œã‚‹

### ãªã‚“ã§éšå±¤åŒ–ã™ã‚‹ã®ï¼Ÿ

**ç†ç”±1ï¼šã‚¬ãƒãƒŠãƒ³ã‚¹**
```
platformé…ä¸‹ï¼šå³ã—ã„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼
sandboxé…ä¸‹ï¼šç·©ã„ãƒãƒªã‚·ãƒ¼ï¼ˆå®Ÿé¨“ç”¨ï¼‰
```

**ç†ç”±2ï¼šæ¨©é™ç®¡ç†**
```
platformã®ç®¡ç†è€…ï¼šplatformé…ä¸‹ã ã‘è§¦ã‚Œã‚‹
landingzonesã®ç®¡ç†è€…ï¼šlandingzonesé…ä¸‹ã ã‘è§¦ã‚Œã‚‹
```

**ç†ç”±3ï¼šã‚³ã‚¹ãƒˆç®¡ç†**
```
platformï¼šã‚¤ãƒ³ãƒ•ãƒ©ã‚³ã‚¹ãƒˆ
landingzonesï¼šã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ã‚¹ãƒˆ
â†’ åˆ†ã‘ã¦é›†è¨ˆã§ãã‚‹
```

---

## Part 1: ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å®šç¾©ï¼ˆalz_custom.alz_architecture_definition.yamlï¼‰

### ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ 

```
lib/
  â””â”€â”€ architecture_definitions/
      â””â”€â”€ alz_custom.alz_architecture_definition.yaml  # â†ã“ã‚Œ
```

### å†…å®¹ã‚’è¦‹ã¦ã¿ã‚ˆã†

```yaml
name: alz_custom
management_groups:
  - id: alz
    display_name: Azure Landing Zones
    archetypes:
      - root_custom
    exists: false
    parent_id: null
```

**ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è§£èª¬**ï¼š

#### id
```yaml
id: alz
```

**ä½•ï¼Ÿ**ï¼šç®¡ç†ã‚°ãƒ«ãƒ¼ãƒ—ã®IDï¼ˆãƒ—ãƒ­ã‚°ãƒ©ãƒ å†…ã§ä½¿ã†åå‰ï¼‰

**ãƒ«ãƒ¼ãƒ«**ï¼š
- å°æ–‡å­—è‹±æ•°å­—ã¨ãƒã‚¤ãƒ•ãƒ³ã®ã¿
- ä¸€æ„ï¼ˆé‡è¤‡ä¸å¯ï¼‰

#### display_name
```yaml
display_name: Azure Landing Zones
```

**ä½•ï¼Ÿ**ï¼šè¡¨ç¤ºåï¼ˆäººé–“ãŒè¦‹ã‚‹åå‰ï¼‰

Azureãƒãƒ¼ã‚¿ãƒ«ã§ã“ã®åå‰ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã€‚

#### archetypes
```yaml
archetypes:
  - root_custom
```

**ä½•ï¼Ÿ**ï¼šé©ç”¨ã™ã‚‹ãƒãƒªã‚·ãƒ¼ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

`lib/archetype_definitions/root_custom.alz_archetype_override.yaml`ã‚’å‚ç…§ã€‚

#### exists
```yaml
exists: false
```

**ä½•ï¼Ÿ**ï¼šæ—¢ã«å­˜åœ¨ã™ã‚‹ã‹ï¼Ÿ

- `false`ï¼šTerraformã§ä½œæˆ
- `true`ï¼šæ—¢å­˜ï¼ˆå‚ç…§ã®ã¿ï¼‰

#### parent_id
```yaml
parent_id: null
```

**ä½•ï¼Ÿ**ï¼šè¦ªç®¡ç†ã‚°ãƒ«ãƒ¼ãƒ—ã®ID

- `null`ï¼šãƒ†ãƒŠãƒ³ãƒˆãƒ«ãƒ¼ãƒˆã®ç›´ä¸‹
- `alz`ï¼šalzã®é…ä¸‹

### éšå±¤ã®å…¨ä½“åƒ

```yaml
# ãƒ«ãƒ¼ãƒˆ
- id: alz
  parent_id: null  # â†ãƒ†ãƒŠãƒ³ãƒˆãƒ«ãƒ¼ãƒˆç›´ä¸‹

# ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ 
- id: platform
  parent_id: alz  # â†alzã®é…ä¸‹

# ç®¡ç†ã‚°ãƒ«ãƒ¼ãƒ—ï¼ˆãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ é…ä¸‹ï¼‰
- id: management
  parent_id: platform  # â†platformã®é…ä¸‹

- id: connectivity
  parent_id: platform

- id: identity
  parent_id: platform

- id: security
  parent_id: platform

# ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã‚¾ãƒ¼ãƒ³
- id: landingzones
  parent_id: alz

- id: corp
  parent_id: landingzones  # â†landingzonesã®é…ä¸‹

- id: online
  parent_id: landingzones

# ãã®ä»–
- id: sandbox
  parent_id: alz

- id: decommissioned
  parent_id: alz
```

**å›³ã«ã™ã‚‹ã¨ã“ã†**ï¼š
```
alz
â”œâ”€â”€ platform
â”‚   â”œâ”€â”€ management
â”‚   â”œâ”€â”€ connectivity
â”‚   â”œâ”€â”€ identity
â”‚   â””â”€â”€ security
â”œâ”€â”€ landingzones
â”‚   â”œâ”€â”€ corp
â”‚   â””â”€â”€ online
â”œâ”€â”€ sandbox
â””â”€â”€ decommissioned
```

---

## Part 2: ã‚¢ãƒ¼ã‚­ã‚¿ã‚¤ãƒ—å®šç¾©ï¼ˆarchetype_definitions/ï¼‰

### ã‚¢ãƒ¼ã‚­ã‚¿ã‚¤ãƒ—ã£ã¦ä½•ï¼Ÿ

**ãƒãƒªã‚·ãƒ¼ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ**ã¿ãŸã„ãªã‚‚ã‚“ã€‚

**ä¾‹**ï¼š
- `root_custom`ï¼šãƒ«ãƒ¼ãƒˆç”¨ã®ãƒãƒªã‚·ãƒ¼ã‚»ãƒƒãƒˆ
- `platform_custom`ï¼šãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ç”¨
- `landing_zones_custom`ï¼šãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã‚¾ãƒ¼ãƒ³ç”¨

### ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ 

```
lib/
  â””â”€â”€ archetype_definitions/
      â”œâ”€â”€ root_custom.alz_archetype_override.yaml
      â”œâ”€â”€ platform_custom.alz_archetype_override.yaml
      â”œâ”€â”€ management_custom.alz_archetype_override.yaml
      â”œâ”€â”€ connectivity_custom.alz_archetype_override.yaml
      â”œâ”€â”€ identity_custom.alz_archetype_override.yaml
      â”œâ”€â”€ security_custom.alz_archetype_override.yaml
      â”œâ”€â”€ landing_zones_custom.alz_archetype_override.yaml
      â”œâ”€â”€ corp_custom.alz_archetype_override.yaml
      â”œâ”€â”€ online_custom.alz_archetype_override.yaml
      â”œâ”€â”€ sandbox_custom.alz_archetype_override.yaml
      â””â”€â”€ decommissioned_custom.alz_archetype_override.yaml
```

### root_custom.alz_archetype_override.yaml

```yaml
base_archetype: root
name: root_custom
policy_assignments_to_add: []
policy_assignments_to_remove: []
policy_definitions_to_add: []
policy_definitions_to_remove: []
policy_set_definitions_to_add: []
policy_set_definitions_to_remove: []
role_definitions_to_add: []
role_definitions_to_remove: []
```

**ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è§£èª¬**ï¼š

#### base_archetype
```yaml
base_archetype: root
```

**ä½•ï¼Ÿ**ï¼šãƒ™ãƒ¼ã‚¹ã¨ãªã‚‹ã‚¢ãƒ¼ã‚­ã‚¿ã‚¤ãƒ—

ALZãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«çµ„ã¿è¾¼ã¾ã‚Œã¦ã‚‹`root`ã‚¢ãƒ¼ã‚­ã‚¿ã‚¤ãƒ—ã‚’ç¶™æ‰¿ã€‚

#### policy_assignments_to_add
```yaml
policy_assignments_to_add: []
```

**ä½•ï¼Ÿ**ï¼šè¿½åŠ ã™ã‚‹ãƒãƒªã‚·ãƒ¼å‰²ã‚Šå½“ã¦

**ä¾‹**ï¼ˆã‚«ã‚¹ã‚¿ãƒ ãƒãƒªã‚·ãƒ¼ã‚’è¿½åŠ ã—ãŸã„å ´åˆï¼‰ï¼š
```yaml
policy_assignments_to_add:
  - name: custom-tagging-policy
    policy_definition_id: /providers/Microsoft.Management/managementGroups/alz/providers/Microsoft.Authorization/policyDefinitions/custom-tags
    parameters:
      requiredTags:
        value: ["environment", "owner"]
```

#### policy_assignments_to_remove
```yaml
policy_assignments_to_remove: []
```

**ä½•ï¼Ÿ**ï¼šå‰Šé™¤ã™ã‚‹ãƒãƒªã‚·ãƒ¼å‰²ã‚Šå½“ã¦

**ä¾‹**ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒãƒªã‚·ãƒ¼ã‚’ç„¡åŠ¹åŒ–ã—ãŸã„å ´åˆï¼‰ï¼š
```yaml
policy_assignments_to_remove:
  - Deploy-MDFC-DefenderSQL-AMA
```

Chapter 3ã§è¦‹ãŸè¨­å®šã§ã™ã€‚

---

## Part 3: è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆtfvarsï¼‰

### management_group_settings

Chapter 3ã§è¦‹ãŸã“ã‚Œï¼š

```hcl
management_group_settings = {
  architecture_name = "alz"
  location          = "{{starter_location_01}}"
  
  policy_default_values = {
    ama_change_tracking_data_collection_rule_id = "{{ama_change_tracking_data_collection_rule_id}}"
    ama_mdfc_data_collection_rule_id            = "{{ama_mdfc_data_collection_rule_id}}"
    ama_user_assigned_managed_identity_id       = "{{ama_user_assigned_managed_identity_id}}"
    ama_user_assigned_managed_identity_name     = "{{ama_user_assigned_managed_identity_name}}"
    log_analytics_workspace_id                  = "{{log_analytics_workspace_id}}"
    ddos_protection_plan_id                     = "{{ddos_protection_plan_id}}"
    private_dns_zone_subscription_id            = "{{subscription_id_connectivity}}"
  }
  
  subscription_placement = {
    management   = ["{{subscription_id_management}}"]
    connectivity = ["{{subscription_id_connectivity}}"]
    identity     = ["{{subscription_id_identity}}"]
  }
}
```

### architecture_name

```hcl
architecture_name = "alz"
```

**ä½•ï¼Ÿ**ï¼šä½¿ç”¨ã™ã‚‹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å®šç¾©ã®åå‰

`lib/architecture_definitions/alz_custom.alz_architecture_definition.yaml`ã®`name`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¨ä¸€è‡´ã•ã›ã‚‹ã€‚

### location

```hcl
location = "{{starter_location_01}}"
```

**ä½•ï¼Ÿ**ï¼šç®¡ç†ã‚°ãƒ«ãƒ¼ãƒ—ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã™ã‚‹å ´æ‰€

å®Ÿã¯ç®¡ç†ã‚°ãƒ«ãƒ¼ãƒ—è‡ªä½“ã¯å ´æ‰€ã‚’æŒãŸãªã„ã‚“ã ã‘ã©ã€ãƒãƒªã‚·ãƒ¼å‰²ã‚Šå½“ã¦ã®ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆç”¨ã€‚

### policy_default_values

```hcl
policy_default_values = {
  log_analytics_workspace_id = "{{log_analytics_workspace_id}}"
  ...
}
```

**ä½•ï¼Ÿ**ï¼šãƒãƒªã‚·ãƒ¼ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿

å¤šãã®ãƒãƒªã‚·ãƒ¼ãŒã€ŒLog Analyticsã«ãƒ­ã‚°é€ä¿¡ã€ã‚’è¦æ±‚ã™ã‚‹ã‹ã‚‰ã€ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹IDã‚’ã“ã“ã§ä¸€å…ƒç®¡ç†ã€‚

**ãƒ¡ãƒªãƒƒãƒˆ**ï¼š
```hcl
# ã“ã‚Œã‚„ã‚‰ãªãã¦ã„ã„ï¼ˆè‡ªå‹•ã§è¨­å®šã•ã‚Œã‚‹ï¼‰
policy_assignment "logging" {
  parameters = {
    log_analytics_workspace_id = "/subscriptions/.../workspaces/law-jp"
  }
}
```

### subscription_placement

```hcl
subscription_placement = {
  management   = ["{{subscription_id_management}}"]
  connectivity = ["{{subscription_id_connectivity}}"]
  identity     = ["{{subscription_id_identity}}"]
}
```

**ä½•ï¼Ÿ**ï¼šã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã©ã®ç®¡ç†ã‚°ãƒ«ãƒ¼ãƒ—ã«é…ç½®ã™ã‚‹ã‹

**ä¾‹**ï¼š
```hcl
subscription_placement = {
  management   = ["12345678-1234-1234-1234-123456789012"]
  connectivity = ["87654321-4321-4321-4321-210987654321"]
  corp         = ["aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeeee", "ffffffff-gggg-hhhh-iiii-jjjjjjjjjjjj"]
}
```

**çµæœ**ï¼š
```
management ã‚°ãƒ«ãƒ¼ãƒ—
  â””â”€â”€ ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ 12345678-...

connectivity ã‚°ãƒ«ãƒ¼ãƒ—
  â””â”€â”€ ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ 87654321-...

corp ã‚°ãƒ«ãƒ¼ãƒ—
  â”œâ”€â”€ ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ aaaaaaaa-...
  â””â”€â”€ ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ ffffffff-...
```

---

## Part 4: ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å‘¼ã³å‡ºã—ï¼ˆmain.management.tfï¼‰

### management_groups ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«

```hcl
module "management_groups" {
  source = "./modules/management_groups"

  count = var.management_groups_enabled ? 1 : 0

  enable_telemetry          = var.enable_telemetry
  management_group_settings = local.management_group_settings
}
```

#### count

```hcl
count = var.management_groups_enabled ? 1 : 0
```

**ä½•ã‚’ã—ã¦ã„ã‚‹ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿ**
ç®¡ç†ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆã®æœ‰åŠ¹/ç„¡åŠ¹ã‚’åˆ‡ã‚Šæ›¿ãˆã€‚

**ä½¿ã„é“**ï¼š
```hcl
# tfvars
management_groups_enabled = false  # â†ç®¡ç†ã‚°ãƒ«ãƒ¼ãƒ—ä½œã‚‰ãªã„ï¼ˆæ—¢å­˜ä½¿ã†ï¼‰

# ã¾ãŸã¯
management_groups_enabled = true  # â†ä½œã‚‹
```

#### management_group_settings

```hcl
management_group_settings = local.management_group_settings
```

Chapter 5ã§è¦‹ãŸ`locals.tf`ã§å‡¦ç†ã•ã‚ŒãŸè¨­å®šãŒæ¸¡ã•ã‚Œã‚‹ã€‚

### modules/management_groups/main.tf

```hcl
module "management_groups" {
  source  = "Azure/avm-ptn-alz/azurerm"
  version = "0.14.1"
  
  architecture_name                     = var.management_group_settings.architecture_name
  parent_resource_id                    = var.management_group_settings.parent_resource_id
  location                              = var.management_group_settings.location
  policy_default_values                 = local.policy_default_values
  policy_assignments_to_modify          = local.policy_assignments_to_modify
  subscription_placement                = var.management_group_settings.subscription_placement
  dependencies                          = var.management_group_settings.dependencies
  ...
}
```

**Azureå…¬å¼ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«**ã‚’ä½¿ã£ã¦ã‚‹ã€‚

**URL**ï¼š
https://registry.terraform.io/modules/Azure/avm-ptn-alz/azurerm

---

## ãƒãƒªã‚·ãƒ¼ã®ä»•çµ„ã¿

### ãƒãƒªã‚·ãƒ¼ã®ç¨®é¡

#### 1. Auditï¼ˆç›£æŸ»ï¼‰

```
ã€Œã“ã‚Œã‚„ã£ã¡ã‚ƒãƒ€ãƒ¡ã ã‘ã©ã€ã‚„ã£ã¦ã‚‚ã‚¨ãƒ©ãƒ¼ã«ã¯ã—ãªã„ã€
â†’ ãƒãƒªã‚·ãƒ¼é•åã¨ã—ã¦è¨˜éŒ²
```

**ä¾‹**ï¼š
- ãƒ‘ãƒ–ãƒªãƒƒã‚¯IPã‚’ä½œæˆã—ãŸã‚‰è­¦å‘Š
- NSGãŒãªã„VMã‚’ä½œæˆã—ãŸã‚‰è­¦å‘Š

#### 2. Denyï¼ˆæ‹’å¦ï¼‰

```
ã€Œã“ã‚Œã‚„ã£ã¡ã‚ƒãƒ€ãƒ¡ã€‚ã‚„ã‚ã†ã¨ã—ãŸã‚‰ã‚¨ãƒ©ãƒ¼ã€
â†’ ãƒªã‚½ãƒ¼ã‚¹ä½œæˆã‚’æ‹’å¦
```

**ä¾‹**ï¼š
- ç‰¹å®šãƒªãƒ¼ã‚¸ãƒ§ãƒ³ä»¥å¤–ã§ã®ãƒªã‚½ãƒ¼ã‚¹ä½œæˆã‚’æ‹’å¦
- æš—å·åŒ–ãªã—ã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ä½œæˆã‚’æ‹’å¦

#### 3. DeployIfNotExistsï¼ˆè‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ï¼‰

```
ã€Œã“ã‚ŒãŒãªã‹ã£ãŸã‚‰è‡ªå‹•ã§ä½œã‚‹ã€
â†’ ä¸è¶³ã—ã¦ã„ã‚‹ãƒªã‚½ãƒ¼ã‚¹ã‚’è‡ªå‹•ä½œæˆã—ã¾ã™
```

**ä¾‹**ï¼š
- VMã‚’ä½œã£ãŸã‚‰è‡ªå‹•ã§Monitoring Agentè¿½åŠ 
- Diagnostic Settingsè‡ªå‹•è¨­å®š

#### 4. Modifyï¼ˆå¤‰æ›´ï¼‰

```
ã€Œã‚¿ã‚°ã¨ã‹è¨­å®šã‚’è‡ªå‹•ã§å¤‰æ›´ã€
â†’ ãƒªã‚½ãƒ¼ã‚¹ã®å±æ€§ã‚’å¤‰æ›´
```

**ä¾‹**ï¼š
- ã‚¿ã‚°ã‚’è‡ªå‹•è¿½åŠ 
- NSGãƒ«ãƒ¼ãƒ«ã‚’è‡ªå‹•è¿½åŠ 

### ãƒãƒªã‚·ãƒ¼ã®å‰²ã‚Šå½“ã¦

```
ç®¡ç†ã‚°ãƒ«ãƒ¼ãƒ—ã«ãƒãƒªã‚·ãƒ¼å‰²ã‚Šå½“ã¦
  â†“
å­ç®¡ç†ã‚°ãƒ«ãƒ¼ãƒ—ã«ç¶™æ‰¿
  â†“
ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã«ç¶™æ‰¿
  â†“
ãƒªã‚½ãƒ¼ã‚¹ã‚°ãƒ«ãƒ¼ãƒ—ã«é©ç”¨
  â†“
ãƒªã‚½ãƒ¼ã‚¹ã«é©ç”¨
```

**ä¾‹**ï¼š
```
alzï¼ˆãƒ«ãƒ¼ãƒˆï¼‰
  â””â”€â”€ ãƒãƒªã‚·ãƒ¼ï¼šã€Œjapaneastä»¥å¤–ç¦æ­¢ã€
      â†“
platform
  â””â”€â”€ ç¶™æ‰¿ï¼šã€Œjapaneastä»¥å¤–ç¦æ­¢ã€
      â†“
connectivity
  â””â”€â”€ ç¶™æ‰¿ï¼šã€Œjapaneastä»¥å¤–ç¦æ­¢ã€
      â†“
ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³
  â””â”€â”€ ç¶™æ‰¿ï¼šã€Œjapaneastä»¥å¤–ç¦æ­¢ã€
      â†“
ãƒªã‚½ãƒ¼ã‚¹ä½œæˆæ™‚ã«ãƒã‚§ãƒƒã‚¯
```

---

## å®Ÿè·µï¼šã‚«ã‚¹ã‚¿ãƒ ãƒãƒªã‚·ãƒ¼ã‚’è¿½åŠ ã—ã¦ã¿ã‚ˆã†

### ä¾‹1: ã‚¿ã‚°å¿…é ˆåŒ–

#### 1. ã‚¢ãƒ¼ã‚­ã‚¿ã‚¤ãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ç·¨é›†

```yaml
# lib/archetype_definitions/root_custom.alz_archetype_override.yaml
base_archetype: root
name: root_custom
policy_assignments_to_add:
  - name: Require-Tags
    display_name: "Require specific tags on resources"
    policy_definition_id: /providers/Microsoft.Authorization/policyDefinitions/96670d01-0a4d-4649-9c89-2d3abc0a5025
    parameters:
      tagNames:
        value:
          - environment
          - owner
          - cost_center
```

#### 2. Terraformå®Ÿè¡Œ

```bash
terraform plan
# â†“ãƒãƒªã‚·ãƒ¼å‰²ã‚Šå½“ã¦ãŒè¿½åŠ ã•ã‚Œã‚‹

terraform apply
```

#### 3. çµæœ

```
ãƒªã‚½ãƒ¼ã‚¹ä½œæˆæ™‚ï¼š
âŒ ã‚¿ã‚°ãªã— â†’ ã‚¨ãƒ©ãƒ¼
âŒ environment ã ã‘ â†’ ã‚¨ãƒ©ãƒ¼ï¼ˆownerã€cost_centerãŒãªã„ï¼‰
âœ… 3ã¤å…¨éƒ¨ã‚ã‚‹ â†’ OK
```

### ä¾‹2: æ—¢å­˜ãƒãƒªã‚·ãƒ¼ã®å‰Šé™¤

Chapter 3ã§è¦‹ãŸDefender for SQLã‚’ç„¡åŠ¹åŒ–ã™ã‚‹ä¾‹ã€‚

```yaml
# lib/archetype_definitions/root_custom.alz_archetype_override.yaml
policy_assignments_to_remove:
  - Deploy-MDFC-DefenderSQL-AMA
```

**ç†ç”±**ï¼š
- ã‚³ã‚¹ãƒˆãŒã‹ã‹ã‚‹
- ä½¿ã£ã¦ãªã„ã‹ã‚‰ç„¡åŠ¹åŒ–ã—ãŸã„

---

## ãƒ‡ãƒãƒƒã‚°æŠ€

### ç®¡ç†ã‚°ãƒ«ãƒ¼ãƒ—ã®ç¢ºèª

```bash
# ç®¡ç†ã‚°ãƒ«ãƒ¼ãƒ—ä¸€è¦§
az account management-group list --output table

# ç‰¹å®šã®ç®¡ç†ã‚°ãƒ«ãƒ¼ãƒ—ã®è©³ç´°
az account management-group show --name alz

# éšå±¤æ§‹é€ ã‚’è¡¨ç¤º
az account management-group show --name alz --expand --recurse
```

### ãƒãƒªã‚·ãƒ¼å‰²ã‚Šå½“ã¦ã®ç¢ºèª

```bash
# ç®¡ç†ã‚°ãƒ«ãƒ¼ãƒ—ã®ãƒãƒªã‚·ãƒ¼å‰²ã‚Šå½“ã¦ä¸€è¦§
az policy assignment list --scope /providers/Microsoft.Management/managementGroups/alz

# ç‰¹å®šã®ãƒãƒªã‚·ãƒ¼å‰²ã‚Šå½“ã¦ã®è©³ç´°
az policy assignment show --name "Require-Tags" --scope /providers/Microsoft.Management/managementGroups/alz
```

### ãƒãƒªã‚·ãƒ¼ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ã®ç¢ºèª

```bash
# ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹çŠ¶æ…‹
az policy state list --resource /providers/Microsoft.Management/managementGroups/alz
```

Azureãƒãƒ¼ã‚¿ãƒ«ï¼š
```
Policy â†’ Compliance
â†“
ç®¡ç†ã‚°ãƒ«ãƒ¼ãƒ—ã”ã¨ã«ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ç‡ãŒè¦‹ãˆã‚‹
```

---

## ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼

### ã‚¨ãƒ©ãƒ¼1: ç®¡ç†ã‚°ãƒ«ãƒ¼ãƒ—åã®é‡è¤‡

```
Error: Management group with id "alz" already exists
```

**åŸå› **ï¼šæ—¢ã«åŒã˜IDã®ç®¡ç†ã‚°ãƒ«ãƒ¼ãƒ—ãŒå­˜åœ¨

**å¯¾å‡¦æ³•**ï¼š
```yaml
# alz_custom.alz_architecture_definition.yaml
- id: alz
  exists: true  # â†æ—¢å­˜ä½¿ã†
```

ã¾ãŸã¯ï¼š

```bash
# æ—¢å­˜å‰Šé™¤
az account management-group delete --name alz
```

### ã‚¨ãƒ©ãƒ¼2: ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã®ç§»å‹•ã‚¨ãƒ©ãƒ¼

```
Error: Cannot move subscription to management group
```

**åŸå› **ï¼šæ¨©é™ä¸è¶³

**å¯¾å‡¦æ³•**ï¼š
```bash
# å¿…è¦ãªæ¨©é™
# - Management Group Contributor
# - ã¾ãŸã¯ Owner

# æ¨©é™ä»˜ä¸
az role assignment create \
  --role "Management Group Contributor" \
  --assignee your@email.com \
  --scope /providers/Microsoft.Management/managementGroups/alz
```

### ã‚¨ãƒ©ãƒ¼3: ãƒãƒªã‚·ãƒ¼å®šç¾©ãŒè¦‹ã¤ã‹ã‚‰ãªã„

```
Error: Policy definition not found
```

**åŸå› **ï¼špolicy_definition_idãŒé–“é•ã£ã¦ã‚‹

**å¯¾å‡¦æ³•**ï¼š
```bash
# ãƒãƒªã‚·ãƒ¼å®šç¾©ã‚’æ¤œç´¢
az policy definition list --query "[?displayName=='Require a tag'].id"

# æ­£ã—ã„IDã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ä½¿ã†
```

---

## ç®¡ç†ã‚°ãƒ«ãƒ¼ãƒ—ã®è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³

### ãƒ‘ã‚¿ãƒ¼ãƒ³1: æ¨™æº–ALZï¼ˆæ¨å¥¨ï¼‰

```
alz
â”œâ”€â”€ platform
â”‚   â”œâ”€â”€ management
â”‚   â”œâ”€â”€ connectivity
â”‚   â”œâ”€â”€ identity
â”‚   â””â”€â”€ security
â”œâ”€â”€ landingzones
â”‚   â”œâ”€â”€ corp
â”‚   â””â”€â”€ online
â””â”€â”€ sandbox
```

**ãƒ¡ãƒªãƒƒãƒˆ**ï¼šMicrosoftã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹
**ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ**ï¼šè¤‡é›‘

### ãƒ‘ã‚¿ãƒ¼ãƒ³2: ã‚·ãƒ³ãƒ—ãƒ«æ§‹æˆ

```
company
â”œâ”€â”€ production
â”œâ”€â”€ development
â””â”€â”€ sandbox
```

**ãƒ¡ãƒªãƒƒãƒˆ**ï¼šã‚ã‹ã‚Šã‚„ã™ã„
**ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ**ï¼šã‚¹ã‚±ãƒ¼ãƒ«ã—ã«ãã„

### ãƒ‘ã‚¿ãƒ¼ãƒ³3: ç’°å¢ƒ Ã— æ©Ÿèƒ½

```
company
â”œâ”€â”€ prod
â”‚   â”œâ”€â”€ apps
â”‚   â”œâ”€â”€ data
â”‚   â””â”€â”€ infrastructure
â”œâ”€â”€ dev
â”‚   â”œâ”€â”€ apps
â”‚   â”œâ”€â”€ data
â”‚   â””â”€â”€ infrastructure
â””â”€â”€ sandbox
```

**ãƒ¡ãƒªãƒƒãƒˆ**ï¼šæŸ”è»Ÿ
**ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ**ï¼šç®¡ç†ãŒè¤‡é›‘

### ãŠã™ã™ã‚ï¼šæ¨™æº–ALZ + ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

```
alz
â”œâ”€â”€ platformï¼ˆãã®ã¾ã¾ï¼‰
â”œâ”€â”€ landingzones
â”‚   â”œâ”€â”€ corp
â”‚   â”œâ”€â”€ online
â”‚   â””â”€â”€ app-specificï¼ˆã‚¢ãƒ—ãƒªå°‚ç”¨è¿½åŠ ï¼‰
â””â”€â”€ sandbox
```

æ¨™æº–æ§‹é€ ã‚’ç¶­æŒã—ã¤ã¤ã€å¿…è¦ã«å¿œã˜ã¦è¿½åŠ ã€‚

---

## ã¾ã¨ã‚

**ç®¡ç†ã‚°ãƒ«ãƒ¼ãƒ—ã®å½¹å‰²**ï¼š
1. **éšå±¤åŒ–**ï¼šã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã‚°ãƒ«ãƒ¼ãƒ”ãƒ³ã‚°
2. **ã‚¬ãƒãƒŠãƒ³ã‚¹**ï¼šãƒãƒªã‚·ãƒ¼ã®ä¸€å…ƒç®¡ç†
3. **æ¨©é™ç®¡ç†**ï¼šRBACã®ç¶™æ‰¿
4. **ã‚³ã‚¹ãƒˆç®¡ç†**ï¼šéšå±¤ã”ã¨ã«é›†è¨ˆ

**ãƒãƒªã‚·ãƒ¼ã®å½¹å‰²**ï¼š
1. **Audit**ï¼šç›£æŸ»ï¼ˆè­¦å‘Šï¼‰
2. **Deny**ï¼šæ‹’å¦ï¼ˆã‚¨ãƒ©ãƒ¼ï¼‰
3. **DeployIfNotExists**ï¼šè‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤
4. **Modify**ï¼šè‡ªå‹•å¤‰æ›´

**è¦šãˆã¦ãŠãã“ã¨**ï¼š
- ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å®šç¾©ï¼ˆYAMLï¼‰ã§éšå±¤æ§‹é€ ã‚’å®šç¾©
- ã‚¢ãƒ¼ã‚­ã‚¿ã‚¤ãƒ—ï¼ˆYAMLï¼‰ã§ãƒãƒªã‚·ãƒ¼ã‚»ãƒƒãƒˆã‚’å®šç¾©
- ãƒãƒªã‚·ãƒ¼ã¯è¦ªã‹ã‚‰å­ã«ç¶™æ‰¿ã•ã‚Œã‚‹
- `policy_assignments_to_remove`ã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒãƒªã‚·ãƒ¼ã‚’ç„¡åŠ¹åŒ–ã§ãã‚‹

æ¬¡ã®Chapterã§ã¯ã€ç®¡ç†ãƒªã‚½ãƒ¼ã‚¹ï¼ˆLog Analyticsã€DCRã€Managed Identityï¼‰ã®ä½œæˆã‚’è¦‹ã¦ã„ãã¾ã™ã€‚
ç›£è¦–ã¨ãƒ­ã‚°åé›†ã®åŸºç›¤ã§ã™ã€‚

---

**æ‰€è¦æ™‚é–“**: 50åˆ†  
**é›£æ˜“åº¦**: â˜…â˜…â˜…â˜…â˜†  
**å‰**: [07_ãƒªã‚½ãƒ¼ã‚¹ã‚°ãƒ«ãƒ¼ãƒ—.md](./07_ãƒªã‚½ãƒ¼ã‚¹ã‚°ãƒ«ãƒ¼ãƒ—.md)  
**æ¬¡**: [09_ç®¡ç†ãƒªã‚½ãƒ¼ã‚¹.md](./09_ç®¡ç†ãƒªã‚½ãƒ¼ã‚¹.md)
